"use strict";window.easycrm||(window.easycrm={},window.easycrm.scriptsLoaded=!1),window.easycrm.scriptsLoaded||(window.easycrm.init=function(){window.easycrm.load_list_script()},window.easycrm.load_list_script=function(){if(!window.easycrm.scriptsLoaded){let e=void 0,a=void 0;for(e in window.easycrm)for(a in window.easycrm[e].init&&window.easycrm[e].init(),window.easycrm[e])window.easycrm[e]&&window.easycrm[e][a]&&window.easycrm[e][a].init&&window.easycrm[e][a].init();window.easycrm.scriptsLoaded=!0}},window.easycrm.refresh=function(){let e=void 0,a=void 0;for(e in window.easycrm)for(a in window.easycrm[e].refresh&&window.easycrm[e].refresh(),window.easycrm[e])window.easycrm[e]&&window.easycrm[e][a]&&window.easycrm[e][a].refresh&&window.easycrm[e][a].refresh()},$(document).ready(window.easycrm.init)),window.easycrm.address={},window.easycrm.address.init=function(){window.easycrm.address.event()},window.easycrm.address.event=function(){$(document).on("click",'[name="favorite_address"]',window.easycrm.address.toggleAddressFavorite)},window.easycrm.address.toggleAddressFavorite=function(){var e=$(this).attr("value");let a=$(this);var o=window.saturne.toolbox.getToken();let i="?";document.URL.match(/\?/)&&(i="&"),$.ajax({url:document.URL+i+"action=toggle_favorite&favorite_id="+e+"&token="+o,type:"POST",processData:!1,contentType:!1,success:function(){var e=$(".fas.fa-star");a.hasClass("far")&&(a.removeClass("far"),a.addClass("fas")),e.removeClass("fas").addClass("far")},error:function(){}})},window.easycrm.quickcreation={},window.easycrm.quickcreation.rotation=0,window.easycrm.quickcreation.img,window.easycrm.quickcreation.latitude,window.easycrm.quickcreation.longitude,window.easycrm.quickcreation.init=function(){window.easycrm.quickcreation.event()},window.easycrm.quickcreation.event=function(){$(document).on("change","#upload-image",window.easycrm.quickcreation.uploadImage),$(document).on("click",".image-rotate-left",function(){window.easycrm.quickcreation.rotateImage(-90)}),$(document).on("click",".image-rotate-right",function(){window.easycrm.quickcreation.rotateImage(90)}),$(document).on("click",".image-undo",window.easycrm.quickcreation.undoLastDraw),$(document).on("click",".image-erase",window.easycrm.quickcreation.clearCanvas),$(document).on("click",".image-validate",window.easycrm.quickcreation.createImg),window.easycrm.quickcreation.getCurrentPosition(),$(document).on("submit",".quickcreation-form",window.easycrm.quickcreation.vibratePhone),$(document).on("input","#opp_percent",window.easycrm.quickcreation.showOppPercentValue)},window.easycrm.quickcreation.uploadImage=function(){var e;this.files&&this.files[0]&&((e=new FileReader).onload=function(e){$(document).find(".modal-upload-image").addClass("modal-active"),window.easycrm.quickcreation.drawImageOnCanvas(e)},e.readAsDataURL(this.files[0]))},window.easycrm.quickcreation.rotateImage=function(e){window.easycrm.quickcreation.rotation+=e,$("#canvas").css("transform","rotate("+window.easycrm.quickcreation.rotation+"deg)")},window.easycrm.quickcreation.undoLastDraw=function(){var e=$(this).closest(".modal-upload-image").find("canvas"),a=e[0].signaturePad.toData();a&&(a.pop(),e[0].signaturePad.fromData(a),window.easycrm.quickcreation.drawImageOnCanvas(window.easycrm.quickcreation.img))},window.easycrm.quickcreation.clearCanvas=function(){$(this).closest(".modal-upload-image").find("canvas")[0].signaturePad.clear(),window.easycrm.quickcreation.drawImageOnCanvas(window.easycrm.quickcreation.img)},window.easycrm.quickcreation.drawImageOnCanvas=function(e){window.easycrm.quickcreation.canvas=document.querySelector("#modal-upload-image0 canvas"),window.easycrm.quickcreation.canvas.signaturePad=new SignaturePad(window.easycrm.quickcreation.canvas,{penColor:"rgb(255, 0, 0)"}),window.easycrm.quickcreation.canvas.signaturePad.clear();var a=new Image;a.src=e.target.result,window.easycrm.quickcreation.img=e,a.onload=function(){var e=window.easycrm.quickcreation.canvas.getContext("2d");window.easycrm.quickcreation.canvas.width=300,window.easycrm.quickcreation.canvas.height=400,e.drawImage(a,0,0,window.easycrm.quickcreation.canvas.width,window.easycrm.quickcreation.canvas.height)},window.easycrm.quickcreation.rotation=0},window.easycrm.quickcreation.createImg=function(){var e=$(this).closest(".wpeo-modal").find("canvas")[0].toDataURL("image/jpeg"),a=window.saturne.toolbox.getToken(),o=window.saturne.toolbox.getQuerySeparator(document.URL),o=document.URL+o+"action=add_img&token="+a;$.ajax({url:o,type:"POST",processData:!1,contentType:"application/octet-stream",data:JSON.stringify({img:e}),success:function(e){$(".wpeo-modal").removeClass("modal-active"),$(".project-container .linked-medias-list").replaceWith($(e).find(".project-container .linked-medias-list"))},error:function(){}})},window.easycrm.quickcreation.getCurrentPosition=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){window.easycrm.quickcreation.latitude=e.coords.latitude,window.easycrm.quickcreation.longitude=e.coords.longitude,$(".project-container #latitude").val(window.easycrm.quickcreation.latitude),$(".project-container #longitude").val(window.easycrm.quickcreation.longitude)},function(e){switch(e.code){case e.PERMISSION_DENIED:$(".project-container #geolocation-error").val("User denied the request for geolocation.");break;case e.POSITION_UNAVAILABLE:$(".project-container #geolocation-error").val("Location information is unavailable.");break;case e.TIMEOUT:$(".project-container #geolocation-error").val("The request to get user location timed out.");break;case e.UNKNOWN_ERROR:$(".project-container #geolocation-error").val("An unknown error occurred.")}}):$(".project-container #geolocation-error").val("Geolocation is not supported by this browser.")},window.easycrm.quickcreation.vibratePhone=function(){"vibrate"in navigator&&navigator.vibrate([1e3,500,200,200,500,1e3]),window.saturne.loader.display($(".page-footer button"))},window.easycrm.quickcreation.showOppPercentValue=function(){$(".opp_percent-value").text($("#opp_percent").val())};